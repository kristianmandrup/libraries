// Generated by LiveScript 1.2.0
(function(){
  var PathShortener, RootPathNormalizer, slice$ = [].slice;
  PathShortener = require('./path-shortener');
  module['export'] = RootPathNormalizer = (function(){
    RootPathNormalizer.displayName = 'RootPathNormalizer';
    var prototype = RootPathNormalizer.prototype, constructor = RootPathNormalizer;
    function RootPathNormalizer(config){
      this.config = config;
    }
    prototype.normalize = function(){
      var root;
      root = this.findRootPath(path.dirname(file[0]));
      if (!isBlank(root)) {
        this.config.dir = root;
        return this.pathShortener().shortenPaths();
      }
    };
    prototype.findRootPath = function(filePath, lv, root){
      var paths, matchPath, i$, ref$, len$, file;
      lv == null && (lv = 0);
      paths = filePath.split('/');
      matchPath = slice$.call(paths, 0, lv + 1 || 9e9).join('/');
      for (i$ = 0, len$ = (ref$ = this.files).length; i$ < len$; ++i$) {
        file = ref$[i$];
        if (!matchPath.match(/^#{path}/)) {
          return root;
        }
      }
      return this.findRootPath(file, lv + 1, matchPath);
    };
    prototype.pathShortener = function(){
      return new PathShortener(this.config);
    };
    return RootPathNormalizer;
  }());
}).call(this);
