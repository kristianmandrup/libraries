// Generated by LiveScript 1.2.0
/**
 * User: kristianmandrup
 * Date: 06/10/14
 * Time: 14:40
 */
(function(){
  var ConfigLoader, Component, ListMutator, fs, util, Components, toString$ = {}.toString;
  ConfigLoader = require('../config/loader');
  Component = require('./component');
  ListMutator = require('../list-mutator');
  fs = require('fs');
  util = require('util');
  module.exports = Components = (function(){
    Components.displayName = 'Components';
    var prototype = Components.prototype, constructor = Components;
    importAll$(prototype, arguments[0]);
    function Components(list, path){
      this.list = list;
      this.path = path;
      this.path || (this.path = './xlibs/components');
      this.validate();
      this.loadListedComponents();
      this;
    }
    prototype.validate = function(){
      if (toString$.call(this.list).slice(8, -1) !== 'Array') {
        throw new Error("Must be an Array, was: " + toString$.call(this.list).slice(8, -1));
      }
    };
    prototype.component = function(name){
      return new Component(name, this.componentObject(name));
    };
    prototype.componentObject = function(name){
      if (this.hasComponent(name)) {
        return this.loadListedComponents()[name];
      }
      throw new Error(name + " not found in list of registered components: " + util.inspect(this.list));
    };
    prototype.hasComponent = function(name){
      return this.loadListedComponents()[name];
    };
    prototype.componentsList = function(){
      return this.componentsList || (this.componentsList = Object.keys(this.loadListedComponents()));
    };
    prototype.loadListedComponents = function(){
      return this._listedComponents || (this._listedComponents = this.loadListed());
    };
    prototype.loadListed = function(){
      var i$, ref$, len$, name, found;
      this.configurations = {};
      for (i$ = 0, len$ = (ref$ = this.list).length; i$ < len$; ++i$) {
        name = ref$[i$];
        found = this.configLoader(name).loadIt();
        if (found) {
          this.configurations[name] = found;
        }
        if (!found) {
          console.log("WARNING: " + name + " config file not found");
        }
      }
      return this.configurations;
    };
    prototype.configLoader = function(name){
      return new ConfigLoader(name, this.path);
    };
    prototype.addOne = function(name){
      if (this.has(name)) {
        return this;
      }
      this.list.push(name);
      return this;
    };
    prototype.removeOne = function(name){
      this._removeItem(this.list, name);
      return this;
    };
    prototype.index = function(name){
      return this.list.indexOf(name);
    };
    prototype.output = function(cb){
      return this.component(name).output(cb);
    };
    return Components;
  }(ListMutator));
  function importAll$(obj, src){
    for (var key in src) obj[key] = src[key];
    return obj;
  }
}).call(this);
